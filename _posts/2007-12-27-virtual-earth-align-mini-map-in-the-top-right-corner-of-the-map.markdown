---
layout: post
title: "Virtual Earth 6: Align Mini Map in the Top Right corner of the Map"
date: 2007-12-27 18:35:00 -0600
comments: true
published: true
categories: ["blog", "archives"]
tags: ["Bing Maps"]
redirect_from: 
  - /post/2007/12/27/Virtual-Earth-Align-Mini-Map-in-the-Top-Right-corner-of-the-Map
  - /post/2007/12/27/virtual-earth-align-mini-map-in-the-top-right-corner-of-the-map
---
<!-- more -->
<p>If you take a look at <a href="http://maps.live.com/">maps.live.com</a> you'll see the Mini Map is in the Top Right corner of the map. Virtual Earth doesn't have any alignment options built in when showing the Mini Map. It just&nbsp;allows you to position the mini map using x and y offset coordinates relating to the top left corner of the map. This makes it really easy to show the mini map in relation to the top left corner, but what&nbsp;makes this tricky is the dashboard is already there.</p>
<p>Here's&nbsp;small example&nbsp;I wrote up on how to align the Mini Map in the Top Right corner of the map. This code also hooks into the Maps onresize event so it can move the Mini Map to the desired location when ever the map is resized.</p>
<p>Here's a screenshot of it in action:</p>
<p><img src="/images/posts2009/6/20091227_Virtual_Earth_MiniMap_Align_Top_Right_Corner.png" alt="" /></p>
<p>Here's the code:</p>
<p>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</a>"&gt;<br /> &lt;html&gt;<br /> &lt;head&gt;<br /> &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;<br /> &lt;script type="text/javascript" src="<a href="http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6">http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6</a>" mce_src="<a href="http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6&quot;&gt;&lt;/script">http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6"&gt;&lt;/script</a>&gt;<br /> &lt;/head&gt;</p>
<p>&lt;body onload="PageLoad()"&gt;</p>
<p>&lt;script type="text/javascript"&gt;<br /> var map = null;</p>
<p>var MiniMapSize = VEMiniMapSize.Small; // can also be set to VEMiniMapSize.Large</p>
<p>function PageLoad()<br /> {<br /> &nbsp;&nbsp;&nbsp; // Load the Map on the page when the page loads<br /> &nbsp;&nbsp;&nbsp; map = new VEMap('myMap');<br /> &nbsp;&nbsp;&nbsp; map.LoadMap(new VELatLong(47.6, -122.33), 7, VEMapStyle.Road);<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; // Attach our onresize event handler<br /> &nbsp;&nbsp;&nbsp; map.AttachEvent("onresize", MapResize);<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; // Show the Mini Map<br /> &nbsp;&nbsp;&nbsp; map.ShowMiniMap(0,0,MiniMapSize);<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; // Align the position of the Mini Map where we want it<br /> &nbsp;&nbsp;&nbsp; RealignMiniMap();<br /> }</p>
<p>function MapResize(e)<br /> {<br /> &nbsp;&nbsp;&nbsp; // When the map is resized, Realign the position of the Mini Map<br /> &nbsp;&nbsp;&nbsp; RealignMiniMap();<br /> }</p>
<p>function RealignMiniMap()<br /> {<br /> &nbsp;&nbsp;&nbsp; // Realign the position of the Mini Map so it appears<br /> &nbsp;&nbsp;&nbsp; // where we want it - The Upper Right Corner<br /> &nbsp;&nbsp;&nbsp; var minimap = document.getElementById("MSVE_minimap");<br /> &nbsp;&nbsp;&nbsp; var xoffset = (GetMapWidth() - minimap.offsetWidth);<br /> &nbsp;&nbsp;&nbsp; map.ShowMiniMap(xoffset, 0, MiniMapSize);<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; /// Hide the Mini Map resizer so the Mini Map cannot be resized<br /> &nbsp;&nbsp;&nbsp; document.getElementById("MSVE_minimap_resize").style.display = "none";<br /> }</p>
<p>function GetMapWidth()<br /> {&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; // Get the Width of the Map as an integer<br /> &nbsp;&nbsp;&nbsp; return document.getElementById("myMap").offsetWidth;<br /> }<br /> function GetMapHeight()<br /> {<br /> &nbsp;&nbsp;&nbsp; // Get the Height of the Map as an integer<br /> &nbsp;&nbsp;&nbsp; return document.getElementById("myMap").offsetHeight;<br /> }<br /> &lt;/script&gt;</p>
<p>&lt;div id="myMap" style="position:relative; width:550px; height:400px;"&gt;&lt;/div&gt;</p>
<p>&lt;br /&gt;<br /> &lt;strong&gt;Resize Map:&lt;/strong&gt;&amp;nbsp;<br /> &lt;a href="javascript:MakeMapBigger();" mce_href="javascript:MakeMapBigger();"&gt;Bigger&lt;/a&gt;&amp;nbsp;&amp;nbsp;<br /> &lt;a href="javascript:MakeMapSmaller();" mce_href="javascript:MakeMapSmaller();"&gt;Smaller&lt;/a&gt;<br /> &lt;script type="text/javascript"&gt;<br /> &nbsp;&nbsp;&nbsp; function MakeMapBigger()<br /> &nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var width = GetMapWidth();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var height = GetMapHeight();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.Resize(width + 50, height);<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp; function MakeMapSmaller()<br /> &nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var width = GetMapWidth();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var height = GetMapHeight();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.Resize(width - 50, height);<br /> &nbsp;&nbsp;&nbsp; }<br /> &lt;/script&gt;</p>
<p>&lt;br /&gt;&lt;br /&gt;<br /> &lt;strong&gt;Change Mini Map Size:&lt;/strong&gt;&amp;nbsp;<br /> &lt;a href="javascript:SetMiniMapSize(VEMiniMapSize.Small);" mce_href="javascript:SetMiniMapSize(VEMiniMapSize.Small);"&gt;Small&lt;/a&gt;&amp;nbsp;&amp;nbsp;<br /> &lt;a href="javascript:SetMiniMapSize(VEMiniMapSize.Large);" mce_href="javascript:SetMiniMapSize(VEMiniMapSize.Large);"&gt;Large&lt;/a&gt;<br /> &lt;script type="text/javascript"&gt;<br /> &nbsp;&nbsp;&nbsp; function SetMiniMapSize(s)<br /> &nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Set our global variable to the size we want<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MiniMapSize = s;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Show the Mini Map as our desired size<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.ShowMiniMap(0,0,s);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Realign the Mini Map so it's in the desired position<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RealignMiniMap();<br /> &nbsp;&nbsp;&nbsp; }<br /> &lt;/script&gt;</p>
<p>&lt;/body&gt;<br /> &lt;/html&gt;</p>
<p>This code works in IE, Firefox and Safari 3 on Windows. I haven't tested any other browsers, but I assume it'll work in others as well. Another thing to note is that this code will only work if there is only a single Virtual Earth map on the page; it'll break with multiple maps on the same page.</p>
<p>Sorry, I didn't have time to write up a nice article surrounding this code. But, I did add a bunch of comments to make it more readable.</p>
<p>&nbsp;</p>
