---
layout: post
id: ea0010eb-d51d-406a-82b1-3d1c6031a34c
title: "Bing Maps: Modify the Opacity of an Existing Custom Tile Layer"
date: 2009-03-13 19:27:00 -0500
comments: true
published: true
categories: ["blog", "archives"]
tags: ["Bing Maps"]
redirect_from: 
  - /post/2009/03/13/Virtual-Earth-Modify-the-Opacity-of-an-Existing-Custom-Tile-Layer
  - /post/2009/03/13/virtual-earth-modify-the-opacity-of-an-existing-custom-tile-layer
  - /post.aspx?id=ea0010eb-d51d-406a-82b1-3d1c6031a34c
---
<!-- more -->
<p>One of the features that the Custom Tile Layer functionality of the Virtual Earth JavaScript control is the ability to modify the Tile Layers Opacity after it's been added to the Map. It does include HideTileLayer and ShowTileLayer methods to dynamically toggle the display of Custom Tile Layers, but sometimes that's just not enough customization. However, I do have some good news, there is a small technique that you can use to modify the Tile Layer Opacity as necessary.</p>
<h3>How to Change Custom Tile Layer Opacity</h3>
<p>To change the Opacity of a Custom Tile Layer you basically need to Delete and then Re-Add the Custom Tile Layer. However, the technique shown below gets the existing Tile Layer by ID, changes it's Opacity value only, then deletes and re-adds it.</p>
<p>Here's the main javascript method that does the work for you:</p>
<p>[code:js]</p>
<p>function SetTileLayerOpacity(tileLayerID, newOpacity) {<br /> &nbsp;&nbsp;&nbsp; // Get TileLayer<br /> &nbsp;&nbsp;&nbsp; var layer = map.GetTileLayerByID(tileLayerID);<br /> <br /> &nbsp;&nbsp;&nbsp; // Set new Opacity Value<br /> &nbsp;&nbsp;&nbsp; layer.Opacity = newOpacity;<br /> <br /> &nbsp;&nbsp;&nbsp; // Delete Existing TileLayer from Map<br /> &nbsp;&nbsp;&nbsp; map.DeleteTileLayer(tileLayerID);<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; // Re-Add the TileLayer with new Opacity<br /> &nbsp;&nbsp;&nbsp; map.AddTileLayer(layer);<br /> }</p>
<p>[/code]</p>
<p>And, here's the simple code needed to change a Custom Tile Layer's Opacity as needed:</p>
<p>[code:js]</p>
<p>SetTileLayerOpacity("tilerLayerID", 0.5);</p>
<p>[/code]</p>
<h3>Complete Code Example</h3>
<p>Here's a full example page that implements the javascript method above. To build this example I actually copied the "Add a tile layer" example from the Virtual Earth Interactive SDK and added the SetTileLayerOpacity methed/functionality to it.</p>
<p>[code:js]</p>
<p>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;<br /> &lt;html&gt;<br /> &lt;head&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;title&gt;&lt;/title&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;script type="text/javascript" src="http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.2"&gt;&lt;/script&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;script type="text/javascript"&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var map = null;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var tileLayer;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function GetMap()<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map = new VEMap('myMap');<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.LoadMap(new VELatLong(48.03,-122.4),12,'r' ,false);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetTiles();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function GetTiles()<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var bounds = [new VELatLongRectangle(new VELatLong(49,-123),new VELatLong(47,-121))];<br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var tileSourceSpec = new VETileSourceSpecification("lidar", "http://dev.live.com/virtualearth/sdk/layers/lidar/%4.png");<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tileSourceSpec.NumServers = 1;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tileSourceSpec.Bounds = bounds;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tileSourceSpec.MinZoomLevel = 10;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tileSourceSpec.MaxZoomLevel = 18;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tileSourceSpec.Opacity = 0.5; //opacity;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tileSourceSpec.ZIndex = 100;<br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.AddTileLayer(tileSourceSpec, true);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function DeleteTileLayer()<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.DeleteTileLayer("lidar");<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function SetTileLayerOpacity(tileLayerID, newOpacity) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Get TileLayer<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var layer = map.GetTileLayerByID(tileLayerID);<br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Set new Opacity Value<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; layer.Opacity = newOpacity;<br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Delete Existing TileLayer from Map<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.DeleteTileLayer(tileLayerID);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Re-Add the TileLayer with new Opacity<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.AddTileLayer(layer);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/script&gt;<br /> &nbsp;&nbsp; &lt;/head&gt;<br /> &nbsp;&nbsp; &lt;body onload="GetMap();"&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;div id='myMap' style="position:relative; width:400px; height:400px;"&gt;&lt;/div&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;a href="#" onclick="SetTileLayerOpacity('lidar', 0.5);"&gt;Set Opacity to 0.5&lt;/a&gt;&lt;br /&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;a href="#" onclick="SetTileLayerOpacity('lidar', 1.0);"&gt;Set Opacity to 1.0&lt;/a&gt;&lt;br /&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;hr /&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;a href="#" onclick="DeleteTileLayer();"&gt;Remove the tile layer&lt;/a&gt;<br /> &nbsp;&nbsp; &lt;/body&gt;<br /> &lt;/html&gt;</p>
<p>[/code]</p>
