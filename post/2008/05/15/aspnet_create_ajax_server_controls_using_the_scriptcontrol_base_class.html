<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ASP.NET: Create AJAX Server Controls using the ScriptControl base class | Chris Pietschmann</title>
    <meta name="description" content="I have more than 20 years of experience in the Software Development industry that includes working as a Consultant and Trainer in a wide array of different industries. Welcome to my resume and work history portfolio website!
">
    <meta name="author" content="Chris Pietschmann">
    <link rel="icon" href="/images/avatar-chris-pietschmann-transparent-small.jpg">
    <link rel="alternate" type="application/rss+xml" title="Chris Pietschmann &raquo; Archive" href="https://pietschsoft.com/feed/" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">

    <!--<link rel="stylesheet" href="/css/site.css">-->
    <link rel="stylesheet" href="/css/site.css">
    <link rel="canonical" href="https://pietschsoft.com/post/2008/05/15/aspnet_create_ajax_server_controls_using_the_scriptcontrol_base_class">

    <!--
    
    -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2908331720107711" crossorigin="anonymous"></script>    
</head>

  <body>
    <header>
  <div class="collapse bg-dark" id="navbarHeader">
    <div class="container">
      <div class="row">
        <div class="col-sm-8 col-md-7 py-4">
          <h4 class="text-white">Bio</h4>
          <p class="text-muted">
            <a href="/">Chris Pietschmann</a> is a Microsoft MVP, HashiCorp Ambassador, Microsoft Certified Trainer (MCT), Author, Trainer, Developer, DevOps / Site Reliability Engineer (SRE) with 20+ years of experience developing enterprise solutions. He has been focusing heavily on Microsoft Azure and the Cloud since early 2010, and specializes in DevOps / SRE, IoT, Development and Solution Architecture. He's the founder of <a href="https://Build5Nines.com">Build5Nines.com</a>, and works at <a href="https://solliance.net">Solliance</a> as a Principal Cloud & DevOps Solution Architect.
          </p>
        </div>
        <div class="col-sm-4 offset-md-1 py-4">
          <h4 class="text-white">Publications</h4>
          <ul class="list-unstyled">
            <li><a href="/#books" class="text-white">Books</a></li>
            <li><a href="https://build5nines.com" class="text-white">Build5Nines.com</a></li>
            <li><a href="https://www.hackster.io/crpietschmann/articles" class="text-white">Hackster.io</a></li>
            <li><a href="/blog" class="text-white">Pietschsoft.com</a></li>
          </ul>
          <h4 class="text-white">Contact</h4>
          <ul class="list-unstyled">
            <li><a href="https://twitter.com/build5nines" class="text-white">Twitter</a></li>
            <li><a href="http://linkedin.com/in/crpietschmann" class="text-white">LinkedIn</a></li>
            <li><a href="https://build5nines.com/contact" class="text-white">Email me</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="navbar navbar-dark bg-dark shadow-sm">
    <div class="container d-flex justify-content-between">
      <a href="/" class="navbar-brand d-flex align-items-center">
        <!--<img src="/images/buildazure-logo.png" alt="Build5Nines.com Logo" style="height: 1.5em; margin-right: 0.5em;"/>-->
        <img src="/images/avatar-chris-pietschmann-transparent-small.jpg" alt="Chris Pietschmann" style="background: #fff; height: 1.5em; margin-right: 0.5em;"/>
        <strong>Chris Pietschmann</strong>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </div>
</header>
    <div class="page-content">
      <div class="wrapper">
        <div class="container post">

  <div class="row">
    <div class="col-12 col-md-8">

      <header class="post-header">
          
          <!--
          
          -->
          <h1 class="post-title">ASP.NET: Create AJAX Server Controls using the ScriptControl base class</h1>
          <!--
          <div class="post-categories">
              
              
              <a href="/categories/#ASP.NET">ASP.NET</a>
              &nbsp;
              
              <a href="/categories/#AJAX">AJAX</a>
              
              
            </div>
          -->
          <p class="post-meta">
            May 15, 2008
            
              &nbsp;•&nbsp;<a href="/category#ASP.NET">ASP.NET</a>
            
              &nbsp;•&nbsp;<a href="/category#AJAX">AJAX</a>
            
          </p>
      </header>

      <article class="post-content">
        
            <!-- more -->

<p>I’ve been doing a lot with ASP.NET AJAX for almost 2 years now, including my <a href="http://simplovation.com/page/webmapsve.aspx">Web.Maps.VE</a> product. So, I’ve decided to spread some of my knowledge in this area by writing up some articles on things that I’ve learned and figured out. <br />
As a note, since .NET 3.5 is the "latest and greatest" version of the framework out at the time of this writing, this article targets .NET 3.5. This article also assumes you have a basic understanding of ASP.NET AJAX and JavaScript.   &lt;h3&gt;What is ScriptControl?&lt;/h3&gt;<br />
First, what exactly is ScriptControl? Well, the base class I’m referring to is the System.Web.UI.ScriptControl base class located within the System.Web.Extensions.dll assembly. <br />
The ScriptControl is basically the first building block you want to use to start building out a WebControl (server control) that will have some kind of rich AJAX functionality in the browser. You may have heard of ASP.NET AJAX Control Extenders, especially if you’re familiar with the AJAX Control Toolkit, so why would we use ScriptControl instead of creating an ExtenderControl in order to give a control some rich AJAX functionality within the browser? Well, you want to create an ExtenderControl to extend or enhance an existing control with some rich AJAX functionality, and you want to inherit from the ScriptControl class when you are creating a full control that will have some rich AJAX functionality. <br />
According to <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.scriptcontrol.aspx">MSDN the ScriptControl class</a> is: <br />
<em>ScriptControl inherits from the WebControl class and implements the <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.iscriptcontrol.aspx">IScriptControl</a> interface. The WebControl class is a base class for ASP.NET Web server controls. The ScriptControl is an abstract class, which you cannot instantiate directly. Instead, you derive a class based on this abstract class.</em> <br />
<em>The ScriptControl base class tests the page for a <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.aspx">ScriptManager</a> control during the PreRender stage of the derived control. The ScriptControl base class also makes sure that the derived control calls methods of the <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.aspx">ScriptManager</a> control to register script during the Render event. This includes registering <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.scriptdescriptor.aspx">ScriptDescriptor</a> objects for the ScriptControl when the Render method is called. The Render method makes sure that <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.scriptdescriptor.aspx">ScriptDescriptor</a> objects are not rendered unless the ScriptControl itself is rendered. This enables a ScriptControl to work inside a closed WebPart control.</em> <br />
<em>You can add as many descriptors and types as necessary to any class that you derive from ScriptControl.</em>  &lt;h3&gt;Basics of Creating Server Controls that Inherit from ScriptControl&lt;/h3&gt;<br />
When first creating your custom server control you inherit from ScriptControl instead of WebControl like usual. The first thing you’ll see is ScriptControl requires you to implement two methods: GetScriptDescriptors and GetScriptReferences. The GetScriptDescriptors method is used to get an enumeration of ScriptDescriptor objects that basically define any of the controls client-side AJAX properties. The GetScriptReferences method is used to get an enumeration of ECMAScript (JavaScript) files that will be loaded on the client-side once the page loads; this is used to basically define any client-side scripts the control will require to run on the client. <br />
Here’s a basic stub of a control that inherits from ScriptControl:  &lt;pre class="csharpcode"&gt;<span class="kwrd">public</span> <span class="kwrd">class</span> CustomScriptControl : ScriptControl
{
    <span class="kwrd">protected</span> <span class="kwrd">override</span> IEnumerable<ScriptDescriptor> GetScriptDescriptors()
    {
        <span class="kwrd">throw</span> <span class="kwrd">new</span> NotImplementedException();
    }</ScriptDescriptor></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;span class="kwrd"&gt;protected&lt;/span&gt; &lt;span class="kwrd"&gt;override&lt;/span&gt; IEnumerable&lt;ScriptReference&gt; GetScriptReferences()
{
    &lt;span class="kwrd"&gt;throw&lt;/span&gt; &lt;span class="kwrd"&gt;new&lt;/span&gt; NotImplementedException();
} }&lt;/pre&gt;
</code></pre></div></div>
<style type="text/css">
.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>

<p><strong>Define ScriptReferences</strong></p>

<p>In the GetScriptReferences method, return an enumeration of the <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.scriptreference.aspx">ScriptReference</a> objects to include in the page on the client-side.</p>

<p>Here’s a basic example of setting up a ScriptReference that includes a script resource that is embedded within the assembly the CustomScriptControl is contained in:</p>

<pre class="csharpcode"><span class="kwrd">protected</span> <span class="kwrd">override</span> IEnumerable<ScriptReference> GetScriptReferences()
{
    List<ScriptReference> references = <span class="kwrd">new</span> List<ScriptReference>();
    references.Add(<span class="kwrd">new</span> ScriptReference(<span class="str">&quot;CustomScriptControl.CustomScriptControl.js&quot;</span>, <span class="str">&quot;CustomScriptControl&quot;</span>));
    <span class="kwrd">return</span> references;
}&lt;/pre&gt;


When inheriting from ScriptControl you'll generally always have at least one ScriptReference because you need to reference the script that creates the client-side JavaScript representation of your control. 


**Define ScriptDescriptors**


In the GetScriptDescriptors method, return an enumeration of ScriptDescriptor objects that define what properties will be passed down to the client-side JavaScript representation of your control. 


The only ScriptDescriptor you need to return in the enumeration is a ScriptControlDescriptor instance that contains all the descriptors for your control. 


Here's a basic example of returning a ScriptControlDescriptor without any properties being defined:

<pre class="csharpcode"><span class="kwrd">protected</span> <span class="kwrd">override</span> IEnumerable<ScriptDescriptor> GetScriptDescriptors()
{
    ScriptControlDescriptor descriptor = <span class="kwrd">new</span> ScriptControlDescriptor(<span class="kwrd">this</span>.GetType().FullName, <span class="kwrd">this</span>.ClientID);
    <span class="kwrd">return</span> <span class="kwrd">new</span> ScriptDescriptor[] { descriptor };
}&lt;/pre&gt;


**What ECMAScript (JavaScript) code is needed?**


There is a basic block of JavaScript code that you'll need to include in the ScriptReference that's being defined by the GetScriptReferences method that will define the client-side JavaScript representation of your control. This basic block of code that you include in this script file is the same for all ScriptControls that you'll create. 


Here's the basic JavaScript that will define the client-side JavaScript representation of the CustomScriptControl we're using in this example. One thing to remember is that the namespaces and object name in the JavaScript file need to be the same as they are in the server-side .NET code.

<pre class="csharpcode">Type.registerNamespace(<span class="str">&quot;CustomScriptControl&quot;</span>);
CustomScriptControl.CustomScriptControl = <span class="kwrd">function</span>(element) {
    CustomScriptControl.CustomScriptControl.initializeBase(<span class="kwrd">this</span>, [element]);
};
CustomScriptControl.CustomScriptControl.prototype = {
    initialize:<span class="kwrd">function</span>() {
        CustomScriptControl.CustomScriptControl.callBaseMethod(<span class="kwrd">this</span>, <span class="str">&quot;initialize&quot;</span>);
    },
    dispose:<span class="kwrd">function</span>() {
        CustomScriptControl.CustomScriptControl.callBaseMethod(<span class="kwrd">this</span>, <span class="str">&quot;dispose&quot;</span>);
    }
};
CustomScriptControl.CustomScriptControl.registerClass(<span class="str">&quot;CustomScriptControl.CustomScriptControl&quot;</span>, Sys.UI.Control);
<span class="kwrd">if</span>(<span class="kwrd">typeof</span>(Sys)!==<span class="str">&quot;undefined&quot;</span>)Sys.Application.notifyScriptLoaded();</pre>
<style type="text/css">
.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>


Also, in order for the ScriptControl to correctly load the &quot;CustomScriptControl.CustomScriptControl.js&quot; script reference that we're using in this example, we must not forget to define the assemblies embedded resource as a Web Resource, like so:

<pre class="csharpcode">[assembly: System.Web.UI.WebResource(<span class="str">&quot;CustomScriptControl.CustomScriptControl.js&quot;</span>, <span class="str">&quot;text/javascript&quot;</span>)]</pre>
<style type="text/css">
.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>

<h3>Let's Add a Little &quot;Rich&quot; AJAX Functionality to the Control</h3>


Now that we have a basic ScriptControl created, we can start to add out &quot;rich&quot; AJAX functionality to it. 


In this article, I'm going to keep things extremely simple, and we're going to do the following: 

<ol>
  <li>Pass a Name (type string) property to the client by defining it as a ScriptDescriptor, and displaying it to the user via a JavaScript Alert dialog. </li>
</ol>


**Add the Name Property to the Control**

<pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">string</span> Name { get; set; }</pre>


**Add the ScriptDescriptor for the Name Property**


Just modify the GetScriptDescriptors method above to look like the following:

<pre class="csharpcode"><span class="kwrd">protected</span> <span class="kwrd">override</span> IEnumerable<ScriptDescriptor> GetScriptDescriptors()
{
    ScriptControlDescriptor descriptor = <span class="kwrd">new</span> ScriptControlDescriptor(<span class="kwrd">this</span>.GetType().FullName, <span class="kwrd">this</span>.ClientID); 

    <span class="rem">// Add our Name property to be passed down to the client</span>
    descriptor.AddProperty(<span class="str">&quot;Name&quot;</span>, <span class="kwrd">this</span>.Name); 

    <span class="kwrd">return</span> <span class="kwrd">new</span> ScriptDescriptor[] { descriptor };
}&lt;/pre&gt;


**Add the Client-Side Name Property that will receive the value**


To do this we need to add a &quot;private&quot; like variable to hold the value and property accessor methods to our JavaScript file. 


Here's the above JavaScript file with the &quot;private&quot; variable and property accessors added for the Name property:

<pre class="csharpcode">Type.registerNamespace(<span class="str">&quot;CustomScriptControl&quot;</span>);
CustomScriptControl.CustomScriptControl = <span class="kwrd">function</span>(element) {
    CustomScriptControl.CustomScriptControl.initializeBase(<span class="kwrd">this</span>, [element]);
    <span class="rem">// &quot;private&quot; variable to hold the Name properties value</span>
    <span class="kwrd">this</span>._name = <span class="kwrd">null</span>;
};
CustomScriptControl.CustomScriptControl.prototype = {
    initialize:<span class="kwrd">function</span>() {
        CustomScriptControl.CustomScriptControl.callBaseMethod(<span class="kwrd">this</span>, <span class="str">&quot;initialize&quot;</span>);
    },
    dispose:<span class="kwrd">function</span>() {
        CustomScriptControl.CustomScriptControl.callBaseMethod(<span class="kwrd">this</span>, <span class="str">&quot;dispose&quot;</span>);
    },
    <span class="rem">// Name Property Accessors</span>
    get_Name:<span class="kwrd">function</span>() {
        <span class="kwrd">return</span> <span class="kwrd">this</span>._name;
    },
    set_Name:<span class="kwrd">function</span>(value) {
        <span class="kwrd">this</span>._name = value;
    }    
};
CustomScriptControl.CustomScriptControl.registerClass(<span class="str">&quot;CustomScriptControl.CustomScriptControl&quot;</span>, Sys.UI.Control);
<span class="kwrd">if</span>(<span class="kwrd">typeof</span>(Sys)!==<span class="str">&quot;undefined&quot;</span>)Sys.Application.notifyScriptLoaded();</pre>


**Display the Name to the User**


In this example we're going to display the Name property to the user using a JavaScript Alert within the objects client-side initialize property. 


Here's the initialize method modified to include the Alert:

<pre class="csharpcode">initialize:<span class="kwrd">function</span>() {
    CustomScriptControl.CustomScriptControl.callBaseMethod(<span class="kwrd">this</span>, <span class="str">&quot;initialize&quot;</span>); 

    <span class="rem">// Display Name property to user</span>
    alert(<span class="kwrd">this</span>.get_Name()); 
},</pre>

<h3>Tips and Tricks</h3>


One trick that I've learned that proves useful when creating custom ScriptControls, is to create your own base class that inherits from ScriptControl and extends it to use some custom attributes to make adding ScriptReferences and ScriptDescriptors easier. 


Here's what the final server-side code of the CustomScriptControl object would look like when using custom attributes to add the ScriptReferences and ScriptDescriptors:

<pre class="csharpcode">[ScriptReference(<span class="str">&quot;CustomScriptControl.CustomScriptControl.js&quot;</span>, <span class="str">&quot;CustomScriptControl&quot;</span>)]
<span class="kwrd">public</span> <span class="kwrd">class</span> CustomScriptControl : ScriptControlBase
{
    [ScriptControlProperty]
    <span class="kwrd">public</span> <span class="kwrd">string</span> Name { get; set; }
}</pre>


As you can see, the new code for the CustomScriptControl using this base class with custom attributes is much cleaner and easier to read. 


Here's the complete code for the ScriptControlBase, ScriptReferenceAttribute and ScriptControlPropertyAttribute objects:

<pre class="csharpcode"><span class="kwrd">using</span> System;
<span class="kwrd">using</span> System.Collections.Generic;
<span class="kwrd">using</span> System.ComponentModel;
<span class="kwrd">using</span> System.Web.UI;

<span class="kwrd">public</span> <span class="kwrd">class</span> ScriptControlBase : ScriptControl
{
    <span class="kwrd">protected</span> <span class="kwrd">override</span> IEnumerable<ScriptDescriptor> GetScriptDescriptors()
    {
        ScriptControlDescriptor descriptor = <span class="kwrd">new</span> ScriptControlDescriptor(<span class="kwrd">this</span>.GetType().FullName, <span class="kwrd">this</span>.ClientID); 

        <span class="rem">// Add all the ScriptControls Client-Side Object Properties</span>
        PropertyDescriptorCollection props = TypeDescriptor.GetProperties(<span class="kwrd">this</span>);
        <span class="kwrd">foreach</span> (PropertyDescriptor prop <span class="kwrd">in</span> props)
        {
            ScriptControlPropertyAttribute propAttr = prop.Attributes[<span class="kwrd">typeof</span>(ScriptControlPropertyAttribute)] <span class="kwrd">as</span> ScriptControlPropertyAttribute;
            <span class="kwrd">if</span> (propAttr != <span class="kwrd">null</span>)
            {
                <span class="kwrd">object</span> <span class="kwrd">value</span> = prop.GetValue(<span class="kwrd">this</span>);
                <span class="kwrd">string</span> name = (propAttr.Name != <span class="kwrd">null</span>) ? propAttr.Name : prop.Name;
                <span class="kwrd">if</span> (<span class="kwrd">value</span> != <span class="kwrd">null</span>)
                {
                    descriptor.AddProperty(name, <span class="kwrd">value</span>);
                }
            }
        } 

        <span class="kwrd">return</span> <span class="kwrd">new</span> ScriptDescriptor[] { descriptor };
    } 

    <span class="kwrd">protected</span> <span class="kwrd">override</span> IEnumerable<ScriptReference> GetScriptReferences()
    {
        List<ScriptReference> references = <span class="kwrd">new</span> List<ScriptReference>(); 

        <span class="rem">// Add all the ScriptControls Client-Side JavaScript References</span>
        <span class="kwrd">object</span>[] scriptReferences = Attribute.GetCustomAttributes(<span class="kwrd">this</span>.GetType(), <span class="kwrd">typeof</span>(ScriptReferenceAttribute), <span class="kwrd">false</span>);
        <span class="kwrd">foreach</span> (ScriptReferenceAttribute r <span class="kwrd">in</span> scriptReferences)
        {
            references.Add(r.GetScriptReference());
        } 

        <span class="kwrd">return</span> references;
    }
} 

[AttributeUsage(AttributeTargets.Property, AllowMultiple = <span class="kwrd">false</span>)]
<span class="kwrd">public</span> <span class="kwrd">class</span> ScriptControlPropertyAttribute : Attribute
{
    <span class="kwrd">public</span> ScriptControlPropertyAttribute() { } 

    <span class="kwrd">public</span> ScriptControlPropertyAttribute(<span class="kwrd">string</span> name)
    {
        <span class="kwrd">this</span>.Name = name;
    } 

    <span class="kwrd">public</span> <span class="kwrd">string</span> Name { get; set; }
} 

[AttributeUsage(AttributeTargets.Class, AllowMultiple = <span class="kwrd">true</span>)]
<span class="kwrd">public</span> <span class="kwrd">class</span> ScriptReferenceAttribute : Attribute
{
    <span class="kwrd">public</span> ScriptReferenceAttribute(<span class="kwrd">string</span> path)
    {
        <span class="kwrd">this</span>.Path = path;
    } 

    <span class="kwrd">public</span> ScriptReferenceAttribute(<span class="kwrd">string</span> name, <span class="kwrd">string</span> assembly)
    {
        <span class="kwrd">this</span>.Name = name;
        <span class="kwrd">this</span>.Assembly = assembly;
    } 

    <span class="kwrd">private</span> <span class="kwrd">string</span> _path = <span class="kwrd">null</span>;
    <span class="kwrd">public</span> <span class="kwrd">string</span> Path
    {
        get { <span class="kwrd">return</span> _path; }
        set { _path = <span class="kwrd">value</span>; }
    } 

    <span class="kwrd">private</span> <span class="kwrd">string</span> _name = <span class="kwrd">null</span>;
    <span class="kwrd">public</span> <span class="kwrd">string</span> Name
    {
        get { <span class="kwrd">return</span> _name; }
        set { _name = <span class="kwrd">value</span>; }
    } 

    <span class="kwrd">private</span> <span class="kwrd">string</span> _assembly = <span class="kwrd">null</span>;
    <span class="kwrd">public</span> <span class="kwrd">string</span> Assembly
    {
        get { <span class="kwrd">return</span> _assembly; }
        set { _assembly = <span class="kwrd">value</span>; }
    } 

    <span class="kwrd">public</span> ScriptReference GetScriptReference()
    {
        ScriptReference r = <span class="kwrd">null</span>; 

        <span class="kwrd">if</span> (<span class="kwrd">this</span>.Path == <span class="kwrd">null</span>)
        {
            r = <span class="kwrd">new</span> ScriptReference(<span class="kwrd">this</span>.Name, <span class="kwrd">this</span>.Assembly);
        }
        <span class="kwrd">else</span>
        {
            r = <span class="kwrd">new</span> ScriptReference(<span class="kwrd">this</span>.Path);
        } 

        <span class="kwrd">return</span> r;
    }
}&lt;/pre&gt;

<h3>Conclusion</h3>


As you can see it's fairly simple to get started creating your own custom server controls that inherit from ScriptControl, especially if you use the above ScriptControlBase class along with its ScriptControlPropertyAttribute and ScriptReferenceAttribute attributes. 


Download Full Source Code: <a href="/files/CreateAJAXServerControlUsingScriptControlBaseClass.zip" rel="enclosure">CreateAJAXServerControlUsingScriptControlBaseClass.zip (33.31 kb)</a> 


**Update 5/31/2008:** I recently posted an article titled &quot;<a href="/post/2008/05/ASPNET_35_Create_AJAX_Extender_Controls_using_the_ExtenderControl_base_class.aspx">Create AJAX Extender Controls using the ExtenderControl base class</a>&quot; on how to create Extender Controls in ASP.NET using the System.Web.UI.ExtenderControl base class. 
</ScriptReference></ScriptReference></ScriptReference></ScriptDescriptor></pre></ScriptDescriptor></pre></ScriptDescriptor></pre></ScriptReference></ScriptReference></ScriptReference></pre>

        
      </article>

      <!--- ADSENSE -->
<!--
<div data-type="ad" data-publisher="lqm.pietschsoft.site" data-format="300x250" data-zone="ros" ></div>
-->

      

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    



    </div>
    <div id="sidebar" class="col-md-4">
      <div class="mb-3">
    <!-- ADSENSE-->
    <!--
    <center>
        <div data-type="ad" data-publisher="lqm.pietschsoft.site" data-zone="ron" data-format="300x250"></div>
    </center>
    -->
    <!--
    <div class="mb-3">
    <a href="https://build5nines.com" alt="Build5Nines.com - Cloud &amp; Enterprise Technology"><img src="https://build5nines.com/wp-content/uploads/2019/07/Build_Azure_Banner_Ad_300x250_1.png" alt="Build5Nines.com - Cloud &amp; Enterprise Technology"/></a>
    </div>
    -->

    <!-- https://blog.webjeda.com/jekyll-related-posts/#whats-wrong-with-jekyll-related_posts -->
    <div class="recent">
    <h4>Recent Posts</h4>
    <ul class="list-unstyled">
        
        <li class="mb-3">
            <h6 class="mb-0"><a href="/post/2024/03/22/javascript-include-file-in-another-javascript-file">Include Javascript File in Another Javascript File</a></h6>
            <span class="small text-muted">22 Mar 2024</span>
        </li>
        
        <li class="mb-3">
            <h6 class="mb-0"><a href="/post/2024/03/22/javascript-how-closures-work">Javascript: How Closures Work</a></h6>
            <span class="small text-muted">22 Mar 2024</span>
        </li>
        
        <li class="mb-3">
            <h6 class="mb-0"><a href="/post/2024/03/22/javascript-how-to-print-to-console-log">Javascript: Redirect to another webpage with Javascript and jQuery</a></h6>
            <span class="small text-muted">22 Mar 2024</span>
        </li>
        
        <li class="mb-3">
            <h6 class="mb-0"><a href="/post/2024/03/21/javascript-check-if-string-contains-substring">Javascript: Check if string contains a substring</a></h6>
            <span class="small text-muted">21 Mar 2024</span>
        </li>
        
        <li class="mb-3">
            <h6 class="mb-0"><a href="/post/2023/12/06/javascript-how-to-print-to-console-log">JavaScript: How to Print to Console, console.log, console.error, console.debug</a></h6>
            <span class="small text-muted">06 Dec 2023</span>
        </li>
        
    </ul>
    </div>

    <div class="related">
    

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    

    
    
        
            
        
    
        
            
        
    


    </div>

    <div class="recent">
        <h4>Recent on Build5Nines.com</h4>
        
        <div class="card" style="width: 18rem; margin:0.5em;">
          <a href="https://build5nines.com/azure-bicep-create-azure-openai-service-and-gpt-4-gpt-35-turbo-model-deployment/"><img src="https://i0.wp.com/build5nines.com/wp-content/uploads/2022/08/Microsoft_Azure_Bicep_Featured_Image.jpg?fit=1200%2C675&ssl=1" class="card-img-top" alt="Azure Bicep: Create Azure OpenAI Service and GPT-4 / GPT-35-turbo Model Deployment"></a>
          <div class="card-body">
            <h5 class="card-title"><a href="https://build5nines.com/azure-bicep-create-azure-openai-service-and-gpt-4-gpt-35-turbo-model-deployment/">Azure Bicep: Create Azure OpenAI Service and GPT-4 / GPT-35-turbo Model Deployment</a></h5>
            <h6 class="card-subtitle mb-2 text-muted">Mar 15, 2024</h6>
            <!--
            <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            -->
            <a href="https://build5nines.com/azure-bicep-create-azure-openai-service-and-gpt-4-gpt-35-turbo-model-deployment/" class="card-link btn btn-primary">Read it</a>
          </div>
        </div>
        
        <div class="card" style="width: 18rem; margin:0.5em;">
          <a href="https://build5nines.com/terraform-create-azure-openai-service-and-gpt-4-gpt-35-turbo-model-deployment/"><img src="https://i0.wp.com/build5nines.com/wp-content/uploads/2022/08/Azure_Terraform_Featured_Image.jpg?fit=1200%2C675&ssl=1" class="card-img-top" alt="Terraform: Create Azure OpenAI Service and GPT-4 / GPT-35-turbo Model Deployment"></a>
          <div class="card-body">
            <h5 class="card-title"><a href="https://build5nines.com/terraform-create-azure-openai-service-and-gpt-4-gpt-35-turbo-model-deployment/">Terraform: Create Azure OpenAI Service and GPT-4 / GPT-35-turbo Model Deployment</a></h5>
            <h6 class="card-subtitle mb-2 text-muted">Mar 15, 2024</h6>
            <!--
            <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            -->
            <a href="https://build5nines.com/terraform-create-azure-openai-service-and-gpt-4-gpt-35-turbo-model-deployment/" class="card-link btn btn-primary">Read it</a>
          </div>
        </div>
        
        <div class="card" style="width: 18rem; margin:0.5em;">
          <a href="https://build5nines.com/github-actions-run-pandoc-to-convert-markdown-to-word-document/"><img src="https://i0.wp.com/build5nines.com/wp-content/uploads/2023/02/GitHub_Actions_Featured_Image.jpg?fit=1200%2C675&ssl=1" class="card-img-top" alt="GitHub Actions: Run Pandoc to convert Markdown to Word Document"></a>
          <div class="card-body">
            <h5 class="card-title"><a href="https://build5nines.com/github-actions-run-pandoc-to-convert-markdown-to-word-document/">GitHub Actions: Run Pandoc to convert Markdown to Word Document</a></h5>
            <h6 class="card-subtitle mb-2 text-muted">Mar 8, 2024</h6>
            <!--
            <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            -->
            <a href="https://build5nines.com/github-actions-run-pandoc-to-convert-markdown-to-word-document/" class="card-link btn btn-primary">Read it</a>
          </div>
        </div>
        
    </div>

    <div class="courses">
        <h4>Courses</h4>
        
          <div class="card" style="width: 18rem; margin:0.5em;">
            <a href="https://learn.build5nines.com/courses/workshop-migrate-rhel-linux-and-mysql-database-to-azure/"><img src="https://i0.wp.com/build5nines.com/wp-content/uploads/2023/01/Build5Nines_Featured_Image.jpg?ssl=1" data-course-featured-media="27493" class="card-img-top" alt="Workshop: Migrate RHEL Linux and MySQL Database to Azure"></a>
            <div class="card-body">
              <h5 class="card-title"><a href="https://learn.build5nines.com/courses/workshop-migrate-rhel-linux-and-mysql-database-to-azure/">Workshop: Migrate RHEL Linux and MySQL Database to Azure</a></h5>
              <h6 class="card-subtitle mb-2 text-muted">free</h6>
              <!--
              <h6 class="card-subtitle mb-2 text-muted">Oct 28, 2023</h6>
              <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
              -->
              <a href="https://learn.build5nines.com/courses/workshop-migrate-rhel-linux-and-mysql-database-to-azure/" class="card-link btn btn-primary">Take Course</a>
            </div>
          </div>
        
          <div class="card" style="width: 18rem; margin:0.5em;">
            <a href="https://learn.build5nines.com/courses/workshop-migrate-windows-server-and-sql-server-to-azure/"><img src="https://i0.wp.com/build5nines.com/wp-content/uploads/2023/01/Build5Nines_Featured_Image.jpg?ssl=1" data-course-featured-media="27395" class="card-img-top" alt="Workshop: Migrate Windows Server and SQL Server to Azure"></a>
            <div class="card-body">
              <h5 class="card-title"><a href="https://learn.build5nines.com/courses/workshop-migrate-windows-server-and-sql-server-to-azure/">Workshop: Migrate Windows Server and SQL Server to Azure</a></h5>
              <h6 class="card-subtitle mb-2 text-muted">free</h6>
              <!--
              <h6 class="card-subtitle mb-2 text-muted">Oct 26, 2023</h6>
              <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
              -->
              <a href="https://learn.build5nines.com/courses/workshop-migrate-windows-server-and-sql-server-to-azure/" class="card-link btn btn-primary">Take Course</a>
            </div>
          </div>
        
        <p><a href="https://learn.build5nines.com">View all courses...</a></p>
        <script>
            document.querySelectorAll('img[data-course-featured-media]').forEach((elem, i) => {
            fetch(`https://learn.build5nines.com/wp-json/wp/v2/media/${elem.getAttribute('data-course-featured-media')}?_fields=source_url`).
                then((response) => {
                    if (response.ok) {
                        return response.json()
                    }
                }).
                then((data) => {
                elem.setAttribute('src', data.source_url);
                });
            });
        </script>
    </div>
    
    <div id="fixedadmarker"></div>
    <div id="fixedad" class="mt-3">
        <!-- ADSENSE -->
        <!--
        <div data-type="ad" data-publisher="lqm.pietschsoft.site" data-zone="ron" data-format="160x600"></div>
        -->
    </div>
    <style>
    @media (min-width: 768px) {
        .fixedad-float {
            position: fixed;
            top: 2.5em;
        }
    }
    </style>
    <script>
    window.setInterval(function() {
        var elem = $('#fixedadmarker'),
            top = elem.offset().top || 0,
            height = elem[0].offsetHeight || 0,
            bottom = top + height,
            scrollY = window.scrollY || 0,
            elemToBeFixed = $('#fixedad');
        if (scrollY >= bottom) {
            elemToBeFixed.addClass('fixedad-float');
        } else {
            elemToBeFixed.removeClass('fixedad-float');
        }
    }, 100);
    </script>
</div>

    </div>
  </div>
</div>

      </div>
    </div>
    <footer class="container py-5">
  <div class="row">
    <div class="col-3 col-md">
      <h5>Chris Pietschmann</h5>
      <ul class="list-unstyled text-small">
        <li><a class="text-muted" href="/#awards">Microsoft MVP</a></li>
        <li><a class="text-muted" href="/#courses">Courses</a></li>
        <li><a class="text-muted" href="/#books">Books</a></li>
        <li><a class="text-muted" href="/#websites">Websites</a></li>
        <li><a class="text-muted" href="/#experience">Experience</a></li>
        <li><a class="text-muted" href="/talks">Talks</a></li>
      </ul>
    </div>
    <div class="col-3 col-md">
      <h5>Publications</h5>
      <ul class="list-unstyled text-small">
        <li><a class="text-muted" href="http://build5nines.com" target="_blank">Build5Nines.com</a></li>
        <li><a class="text-muted" href="https://www.hackster.io/crpietschmann/articles" target="_blank">Hackster.io</a></li>
        <li><a class="text-muted" href="/blog">Pietschsoft.com</a></li>
      </ul>
      <h5>Social Media</h5>
      <ul class="list-unstyled text-small">
        <li><a class="text-muted" href="http://twitter.com/build5nines" target="_blank">Twitter</a></li>
        <li><a class="text-muted" href="http://linkedin.com/in/crpietschmann" target="_blank">LinkedIn</a></li>
        <li><a class="text-muted" href="http://youtube.com/build5nines" target="_blank">YouTube</a></li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <!--<img src="/images/buildazure-logo.png" alt="Build5Nines.com" style="height: 1.5em;"/>-->
      <small class="d-block text-muted">
        Copyright © 2003 - 2024 Chris Pietschmann. All rights reserved.<br/><br/>
        No content may be republished, in part or in whole, without prior written consent.
      </small>
    </div>
  </div>
</footer>

<!-- Bootstrap core JavaScript -->
<!-- Placed at the end of the document so the pages load faster -->
<!--
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
-->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>

<script src="/scripts/prism/prism.js"></script>
<link rel="stylesheet" href="/scripts/prism/prism.css" />


  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QVB6DNH2M1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-QVB6DNH2M1');
  </script>
  </body>
</html>