<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Silverlight: Embed IronRuby/DLR Scripting within XAML using IValueConverter and Custom UserControl | Chris Pietschmann</title>
    <meta name="description" content="I have more than 20 years of experience in the Software Development industry that includes working as a Consultant and Trainer in a wide array of different industries. Welcome to my resume and work history portfolio website!
">
    <meta name="author" content="Chris Pietschmann">
    <link rel="icon" href="/images/avatar-chris-pietschmann-transparent-small.jpg">
    <!--<link rel="icon" href="http://getbootstrap.com/favicon.ico">-->
    <link rel="alternate" type="application/rss+xml" title="Chris Pietschmann &raquo; Archive" href="https://pietschsoft.com/feed/" />

    <!-- Bootstrap core CSS -->
    <!--
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
    -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">

    <!--<link rel="stylesheet" href="/css/site.css">-->
    <link rel="stylesheet" href="/css/site.css">
    <link rel="canonical" href="http://pietschsoft.com/post/2010/10/02/silverlight-embed-ironrubydlr-scripting-within-xaml-using-ivalueconverter-and-custom-usercontrol">
</head>

  <body>
    <header>
  <div class="collapse bg-dark" id="navbarHeader">
    <div class="container">
      <div class="row">
        <div class="col-sm-8 col-md-7 py-4">
          <h4 class="text-white">Bio</h4>
          <p class="text-muted">
            <a href="/">Chris Pietschmann</a> is a Microsoft MVP, HashiCorp Ambassador, Microsoft Certified Trainer (MCT), Author, Trainer, Developer, DevOps / Site Reliability Engineer (SRE) with 20+ years of experience developing enterprise solutions. He has been focusing heavily on Microsoft Azure and the Cloud since early 2010, and specializes in DevOps / SRE, IoT, Development and Solution Architecture. He's the founder of <a href="https://Build5Nines.com">Build5Nines.com</a>, and works at <a href="https://solliance.net">Solliance</a> as a Principal Cloud & DevOps Solution Architect.
          </p>
        </div>
        <div class="col-sm-4 offset-md-1 py-4">
          <h4 class="text-white">Publications</h4>
          <ul class="list-unstyled">
            <li><a href="/#books" class="text-white">Books</a></li>
            <li><a href="https://build5nines.com" class="text-white">Build5Nines.com</a></li>
            <li><a href="https://www.hackster.io/crpietschmann/articles" class="text-white">Hackster.io</a></li>
            <li><a href="/blog" class="text-white">Pietschsoft.com</a></li>
          </ul>
          <h4 class="text-white">Contact</h4>
          <ul class="list-unstyled">
            <li><a href="https://twitter.com/build5nines" class="text-white">Twitter</a></li>
            <li><a href="http://linkedin.com/in/crpietschmann" class="text-white">LinkedIn</a></li>
            <li><a href="https://build5nines.com/contact" class="text-white">Email me</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="navbar navbar-dark bg-dark shadow-sm">
    <div class="container d-flex justify-content-between">
      <a href="/" class="navbar-brand d-flex align-items-center">
        <!--<img src="/images/buildazure-logo.png" alt="Build5Nines.com Logo" style="height: 1.5em; margin-right: 0.5em;"/>-->
        <img src="/images/avatar-chris-pietschmann-transparent-small.jpg" alt="Chris Pietschmann" style="background: #fff; height: 1.5em; margin-right: 0.5em;"/>
        <strong>Chris Pietschmann</strong>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </div>
</header>
    <div class="page-content">
      <div class="wrapper">
        <div class="container post">

  <div class="row">
    <div class="col-12 col-md-8">

      <header class="post-header">
          
          
          <h1 class="post-title">Silverlight: Embed IronRuby/DLR Scripting within XAML using IValueConverter and Custom UserControl</h1>
          <!--
          <div class="post-categories">
              
              
              <a href="/categories/#Silverlight">Silverlight</a>
              &nbsp;
              
              <a href="/categories/#IronRuby">IronRuby</a>
              &nbsp;
              
              <a href="/categories/#DLR">DLR</a>
              
              
            </div>
          -->
          <p class="post-meta">
            Oct 2, 2010
            
              &nbsp;•&nbsp;<a href="/category#Silverlight">Silverlight</a>
            
              &nbsp;•&nbsp;<a href="/category#IronRuby">IronRuby</a>
            
              &nbsp;•&nbsp;<a href="/category#DLR">DLR</a>
            
          </p>
      </header>

      <article class="post-content">
        
            <!-- more -->

<p>After I wrote the “<a href="/post/2010/09/29/Intro-to-IronRubyDLR-Scripting-in-C-Silverlight-4-Application.aspx">Intro to IronRuby/DLR Scripting in C# Silverlight 4 Application</a>” post, I came across an interesting series on <a href="http://www.thinkbottomup.com.au/site/blog/Embedding_DLR_Scripts_in_XAML_Part_6">embedding DLR scripts in XAML with WPF</a>. This is an interesting series, although the code doesn’t run in Silverlight, due to the fact that Silverlight is only a subset of WPF and doesn’t support the <a href="http://msdn.microsoft.com/en-us/library/system.windows.markup.markupextension.aspx">System.Windows.Markup.MarkupExtension</a> class. I test out a couple things in Silverlight, and I was able to get similar DLR scripting functionality working under Silverlight using a combination of a simple, custom <a href="http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx">IValueConverter</a> and a custom UserControl class.<br />
If you are unfamiliar with <a href="http://timheuer.com/blog/archive/2008/07/30/format-data-in-silverlight-databinding-valueconverter.aspx">value converters</a> and the <a href="http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx">IValueConverter</a> interface (same for both Silverlight and WPF), you may want to look it up and learn how to create your own. Value converters are tremendously helpful when performing data binding.  &lt;h3&gt;Embedded IronRuby within XAML&lt;/h3&gt;<br />
To start, here’s a few examples of IronRuby code embedded within a custom IValueConverter and custom UserControl. As you’ll see, this can be very effective to embed scripting to define how to display the values bound, or to manipulate the content of the custom user control. Although, you must keep in mind that this is not limited to simple tasks such as these. You have the full power of the DLR and .NET within the DLR scripts being executed, so there really is no limit to what could be coded within.  &lt;pre class="csharpcode"&gt;<span class="kwrd">«/span&gt;<span class="html">UserControl</span> <span class="attr">x:Class</span><span class="kwrd">="SLXamlEmbeddedScript.MainPage"</span>
    <span class="attr">xmlns</span><span class="kwrd">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
    <span class="attr">xmlns:x</span><span class="kwrd">="http://schemas.microsoft.com/winfx/2006/xaml"</span>
    <span class="attr">xmlns:d</span><span class="kwrd">="http://schemas.microsoft.com/expression/blend/2008"</span>
    <span class="attr">xmlns:mc</span><span class="kwrd">="http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;span class="attr"&gt;xmlns:system&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;clr-namespace:System;assembly=mscorlib&amp;quot;&lt;/span&gt;
&lt;span class="attr"&gt;xmlns:local&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;clr-namespace:SLXamlEmbeddedScript&amp;quot;&lt;/span&gt;
         
&lt;span class="attr"&gt;mc:Ignorable&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;d&amp;quot;&lt;/span&gt;
&lt;span class="attr"&gt;d:DesignHeight&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;300&amp;quot;&lt;/span&gt; &lt;span class="attr"&gt;d:DesignWidth&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;400&amp;quot;&lt;/span&gt;
&lt;span class="attr"&gt;x:Name&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;root&amp;quot;&lt;/span&gt; &lt;span class="attr"&gt;DataContext&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;test&amp;quot;&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
&lt;span class="kwrd"&gt;&lt;&lt;/span&gt;&lt;span class="html"&gt;UserControl.Resources&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
    &lt;span class="rem"&gt;&lt;!-- This converter uses a Ruby object's 'add' method&lt;/span&gt; &lt;span class="rem"&gt;        to add 5 plus 5 and return the results&lt;/span&gt; &lt;span class="rem"&gt;        --&gt;&lt;/span&gt;
    &lt;span class="kwrd"&gt;&lt;&lt;/span&gt;&lt;span class="html"&gt;local:DLRScriptValueConverter&lt;/span&gt; &lt;span class="attr"&gt;x:Key&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;FivePlusFiveConverter&amp;quot;&lt;/span&gt; &lt;span class="attr"&gt;xml:space&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;preserve&amp;quot;&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
        class AddFive
            def add
                5 + 5
            end
        end
        a = AddFive.new
        a.add
    &lt;span class="kwrd"&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;local:DLRScriptValueConverter&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;

    &lt;span class="rem"&gt;&lt;!-- This converter uses the value being bound via data binding,&lt;/span&gt; &lt;span class="rem"&gt;        passed through to IronRuby as 'ConverterValue', and generates a custom&lt;/span&gt; &lt;span class="rem"&gt;        value to return. In this case it concatenates the FirstName and LastName&lt;/span&gt; &lt;span class="rem"&gt;        properties --&gt;&lt;/span&gt;
    &lt;span class="kwrd"&gt;&lt;&lt;/span&gt;&lt;span class="html"&gt;local:DLRScriptValueConverter&lt;/span&gt; &lt;span class="attr"&gt;x:Key&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;GetFullNameConverter&amp;quot;&lt;/span&gt; &lt;span class="attr"&gt;xml:space&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;preserve&amp;quot;&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
        ConverterValue.FirstName + &amp;quot; &amp;quot; + ConverterValue.LastName
    &lt;span class="kwrd"&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;local:DLRScriptValueConverter&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;

&lt;span class="kwrd"&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;UserControl.Resources&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;

&lt;span class="kwrd"&gt;&lt;&lt;/span&gt;&lt;span class="html"&gt;StackPanel&lt;/span&gt; &lt;span class="attr"&gt;x:Name&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;LayoutRoot&amp;quot;&lt;/span&gt; &lt;span class="attr"&gt;Background&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;White&amp;quot;&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
    
    &lt;span class="rem"&gt;&lt;!-- Bind using the FivePlusFiveConverter defined above --&gt;&lt;/span&gt;
    &lt;span class="kwrd"&gt;&lt;&lt;/span&gt;&lt;span class="html"&gt;TextBlock&lt;/span&gt; &lt;span class="attr"&gt;Text&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;{Binding Converter={StaticResource FivePlusFiveConverter}}&amp;quot;&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;TextBlock&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
    
    &lt;span class="rem"&gt;&lt;!-- Bind using the GetFullNameConverter defined above --&gt;&lt;/span&gt;
    &lt;span class="kwrd"&gt;&lt;&lt;/span&gt;&lt;span class="html"&gt;TextBlock&lt;/span&gt; &lt;span class="attr"&gt;Text&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;{Binding ElementName=root, Converter={StaticResource GetFullNameConverter}}&amp;quot;&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;TextBlock&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
    
    &lt;span class="rem"&gt;&lt;!-- Use DLRScriptUserControl (custom UserControl) to embed&lt;/span&gt; &lt;span class="rem"&gt;        IronRuby code within XAML and execute it on the Content of&lt;/span&gt; &lt;span class="rem"&gt;        the control. --&gt;&lt;/span&gt;
    &lt;span class="kwrd"&gt;&lt;&lt;/span&gt;&lt;span class="html"&gt;local:DLRScriptUserControl&lt;/span&gt; &lt;span class="attr"&gt;x:Name&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;testusercontrol&amp;quot;&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
        &lt;span class="kwrd"&gt;&lt;&lt;/span&gt;&lt;span class="html"&gt;local:DLRScriptUserControl.Script&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
            &lt;span class="kwrd"&gt;&lt;&lt;/span&gt;&lt;span class="html"&gt;system:String&lt;/span&gt; &lt;span class="attr"&gt;xml:space&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;preserve&amp;quot;&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
                Ctrl.FindName('txtName').Text = 'Hello from IronRuby'
            &lt;span class="kwrd"&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;system:String&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
        &lt;span class="kwrd"&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;local:DLRScriptUserControl.Script&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
        &lt;span class="kwrd"&gt;&lt;&lt;/span&gt;&lt;span class="html"&gt;local:DLRScriptUserControl.Content&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
            &lt;span class="kwrd"&gt;&lt;&lt;/span&gt;&lt;span class="html"&gt;TextBlock&lt;/span&gt; &lt;span class="attr"&gt;x:Name&lt;/span&gt;&lt;span class="kwrd"&gt;=&amp;quot;txtName&amp;quot;&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;Default&lt;span class="kwrd"&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;TextBlock&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
        &lt;span class="kwrd"&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;local:DLRScriptUserControl.Content&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
    &lt;span class="kwrd"&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;local:DLRScriptUserControl&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;
    
&lt;span class="kwrd"&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;StackPanel&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt; &lt;span class="kwrd"&gt;&lt;/&lt;/span&gt;&lt;span class="html"&gt;UserControl&lt;/span&gt;&lt;span class="kwrd"&gt;&gt;&lt;/span&gt;&lt;/pre&gt;
</code></pre></div></div>
<style type="text/css">


.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>

<p>One thing to not about the above usage code, is that you must use <em>xml:space=”preserve”</em> when embeding the IronRuby/DLR scripts. This will ensure the line breaks are preserved in the resulting string. Without it the code will not run, since the IronRuby syntax depends on those line breaks.</p>

<h3>DLRScriptValueConverter - IValueConverter</h3>

<p>This value converter is really simple, and allows you to specify ConvertScript and ConvertBackScript to allow the value converter to convert in two way mode.</p>

<p>Also, as you’ll see from the code, you could make this value converter work with both IronRuby and IronPython, as the Language property suggests. Although, for this simple example, the only supported language is IronRuby. To support IronPython it’s just a matter of instantiating the appropriate ScriptEngine class to Execute the script with.</p>

<pre class="csharpcode"><span class="kwrd">using</span> System;
<span class="kwrd">using</span> System.Windows.Data;
<span class="kwrd">using</span> System.Windows.Markup;
<span class="kwrd">using</span> Microsoft.Scripting.Hosting;

<span class="kwrd">namespace</span> SLXamlEmbeddedScript
{
    [ContentProperty(<span class="str">&quot;ConvertScript&quot;</span>)]
    <span class="kwrd">public</span> <span class="kwrd">class</span> DLRScriptValueConverter : IValueConverter
    {
        <span class="kwrd">public</span> DLRScriptValueConverter()
        {
            <span class="kwrd">this</span>.Language = <span class="str">&quot;IronRuby&quot;</span>;
        }

        <span class="kwrd">public</span> <span class="kwrd">string</span> Language { get; set; }
        <span class="kwrd">public</span> <span class="kwrd">string</span> ConvertScript { get; set; }
        <span class="kwrd">public</span> <span class="kwrd">string</span> ConvertBackScript { get; set; }

        <span class="preproc">#region</span> IValueConverter Members

        <span class="kwrd">public</span> <span class="kwrd">object</span> Convert(<span class="kwrd">object</span> <span class="kwrd">value</span>, Type targetType, <span class="kwrd">object</span> parameter, System.Globalization.CultureInfo culture)
        {
            <span class="kwrd">if</span> (<span class="kwrd">string</span>.IsNullOrEmpty(<span class="kwrd">this</span>.Language))
            {
                <span class="kwrd">throw</span> <span class="kwrd">new</span> InvalidOperationException(<span class="str">&quot;DLRScriptValueConverter.Language property must be set&quot;</span>);
            }
            
            <span class="kwrd">if</span> (<span class="kwrd">string</span>.IsNullOrEmpty(<span class="kwrd">this</span>.ConvertScript))
            {
                <span class="kwrd">throw</span> <span class="kwrd">new</span> InvalidOperationException(<span class="str">&quot;parameter or DLRScriptValueConverter.ConvertScript property must be contain a value&quot;</span>);
            }

            <span class="kwrd">if</span> (<span class="kwrd">this</span>.Language.ToLowerInvariant() != <span class="str">&quot;ironruby&quot;</span>)
            {
                <span class="kwrd">throw</span> <span class="kwrd">new</span> InvalidOperationException(<span class="kwrd">string</span>.Format(<span class="str">&quot;Unsupported DLR Language ({0}). Currently only IronRuby is supported.&quot;</span>, <span class="kwrd">this</span>.Language));
            }

            <span class="rem">// Create Ruby ScriptEngine</span>
            ScriptEngine engine = IronRuby.Ruby.CreateEngine();

            <span class="rem">// Make the &quot;value&quot; to be converted available to the DLR</span>
            engine.Runtime.Globals.SetVariable(<span class="str">&quot;ConverterValue&quot;</span>, <span class="kwrd">value</span>);

            <span class="rem">// Execute the script and return its result</span>
            <span class="kwrd">return</span> engine.Execute(<span class="kwrd">this</span>.ConvertScript);
        }

        <span class="kwrd">public</span> <span class="kwrd">object</span> ConvertBack(<span class="kwrd">object</span> <span class="kwrd">value</span>, Type targetType, <span class="kwrd">object</span> parameter, System.Globalization.CultureInfo culture)
        {
            <span class="kwrd">if</span> (<span class="kwrd">string</span>.IsNullOrEmpty(<span class="kwrd">this</span>.Language))
            {
                <span class="kwrd">throw</span> <span class="kwrd">new</span> InvalidOperationException(<span class="str">&quot;DLRScriptValueConverter.Language property must be set&quot;</span>);
            }

            <span class="kwrd">if</span> (<span class="kwrd">string</span>.IsNullOrEmpty(<span class="kwrd">this</span>.ConvertBackScript))
            {
                <span class="kwrd">throw</span> <span class="kwrd">new</span> InvalidOperationException(<span class="str">&quot;parameter or DLRScriptValueConverter.ConvertBackScript property must be contain a value&quot;</span>);
            }

            <span class="kwrd">if</span> (<span class="kwrd">this</span>.Language.ToLowerInvariant() != <span class="str">&quot;ironruby&quot;</span>)
            {
                <span class="kwrd">throw</span> <span class="kwrd">new</span> InvalidOperationException(<span class="kwrd">string</span>.Format(<span class="str">&quot;Unsupported DLR Language ({0}). Currently only IronRuby is supported.&quot;</span>, <span class="kwrd">this</span>.Language));
            }

            <span class="rem">// Create Ruby ScriptEngine</span>
            ScriptEngine engine = IronRuby.Ruby.CreateEngine();

            <span class="rem">// Make the &quot;value&quot; to be converted available to the DLR</span>
            engine.Runtime.Globals.SetVariable(<span class="str">&quot;ConverterValue&quot;</span>, <span class="kwrd">value</span>);

            <span class="rem">// Execute the script and return its result</span>
            <span class="kwrd">return</span> engine.Execute(<span class="kwrd">this</span>.ConvertBackScript);
        }

        <span class="preproc">#endregion</span>
    }
}</pre>
<style type="text/css">


.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>

<h3>DLRScriptUserControl – Custom UserControl</h3>

<p>Just like the value converter above, the DLRScriptUserControl control is really simple. It inherits from UserControl to allow you to set the controls Content property to the XAML you want it to display, and implements a Script property that allows you to define the IronRuby script to execute.</p>

<p>When the IronRuby script is executed during the controls Loaded event, the control passes IronRuby a global variable named ‘Ctrl’ that contains a reference to the DLRScriptUserControl object itself. Like the XAML example above, this allows you to execute any code you want against the control once it is Loaded.</p>

<pre class="csharpcode"><span class="kwrd">using</span> System.Windows;
<span class="kwrd">using</span> System.Windows.Controls;
<span class="kwrd">using</span> IronRuby;
<span class="kwrd">using</span> Microsoft.Scripting.Hosting;

<span class="kwrd">namespace</span> SLXamlEmbeddedScript
{
    <span class="kwrd">public</span> <span class="kwrd">class</span> DLRScriptUserControl : UserControl
    {
        <span class="kwrd">public</span> <span class="kwrd">object</span> Script { get; set; }

        <span class="kwrd">public</span> DLRScriptUserControl()
        {
            <span class="kwrd">this</span>.Loaded += <span class="kwrd">new</span> RoutedEventHandler(DLRScriptUserControl_Loaded);
        }

        <span class="kwrd">void</span> DLRScriptUserControl_Loaded(<span class="kwrd">object</span> sender, RoutedEventArgs e)
        {
            <span class="rem">// Create IronRuby Engine</span>
            ScriptEngine engine = Ruby.CreateEngine();
            
            <span class="rem">// Give IronRuby access to this control via a variable named 'Ctrl'</span>
            engine.Runtime.Globals.SetVariable(<span class="str">&quot;Ctrl&quot;</span>, <span class="kwrd">this</span>);
            
            <span class="rem">// Execute the code</span>
            engine.Execute(<span class="kwrd">this</span>.Script <span class="kwrd">as</span> <span class="kwrd">string</span>, engine.CreateScope());
        }
    }
}</pre>
<style type="text/css">


.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>

<h3>Conclusion</h3>

<p>The above code is rather simple, and not meant for production use. It is just a basic prototype framework of how you might embed some DLR scripting within a Silverlight application. One thing I plan on looking into next (and I may or may not blog about it) is using the <a href="http://msdn.microsoft.com/en-us/library/cc190359%28VS.95%29.aspx">XamlReader</a> class to dynamically load the XAML and its embedded DLR script at runtime. The combination of both would allow you to build some very simple plugin-like functionality into your applications.</p>

<p>Hope this helps someone.</p>

<p>**Continued Here: **<a href="/post/2010/10/17/Silverlight-Embed-IronRuby-within-XAML-Part-2.aspx"><strong>Silverlight: Embed IronRuby within XAML Part 2</strong></a></p>

        
      </article>

      <div data-type="ad" data-publisher="lqm.pietschsoft.site" data-format="300x250" data-zone="ros" ></div>


      

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    



    </div>
    <div id="sidebar" class="col-md-4">
      <div class="mb-3">
    <center>
        <div data-type="ad" data-publisher="lqm.pietschsoft.site" data-zone="ron" data-format="300x250"></div>
    </center>
    
    <!--
    <div class="mb-3">
    <a href="https://build5nines.com" alt="Build5Nines.com - Cloud &amp; Enterprise Technology"><img src="https://build5nines.com/wp-content/uploads/2019/07/Build_Azure_Banner_Ad_300x250_1.png" alt="Build5Nines.com - Cloud &amp; Enterprise Technology"/></a>
    </div>
    -->

    <!-- https://blog.webjeda.com/jekyll-related-posts/#whats-wrong-with-jekyll-related_posts -->
    <div class="recent">
    <h4>Recent Posts</h4>
    <ul class="list-unstyled">
        
        <li class="mb-3">
            <h6 class="mb-0"><a href="/post/2023/10/11/javascript-aggrid-hide-column-from-tool-panel">How to Hide a Column in AG-Grid and Prevent it from Displaying in the Tool Panel</a></h6>
            <span class="small text-muted">11 Oct 2023</span>
        </li>
        
        <li class="mb-3">
            <h6 class="mb-0"><a href="/post/2023/10/03/javascript-loop-through-array-using-for-each">JavaScript: Loop through Array (using forEach)</a></h6>
            <span class="small text-muted">03 Oct 2023</span>
        </li>
        
        <li class="mb-3">
            <h6 class="mb-0"><a href="/post/2023/09/28/javascript-parse-string-to-a-date">JavaScript: Parse a String to a Date</a></h6>
            <span class="small text-muted">28 Sep 2023</span>
        </li>
        
        <li class="mb-3">
            <h6 class="mb-0"><a href="/post/2023/09/28/javascript-format-date-to-string">JavaScript: Format Date to String</a></h6>
            <span class="small text-muted">28 Sep 2023</span>
        </li>
        
        <li class="mb-3">
            <h6 class="mb-0"><a href="/post/2023/09/28/javascript-how-to-convert-map-to-array-of-objects">JavaScript: How to Convert Map to an Array of Objects</a></h6>
            <span class="small text-muted">28 Sep 2023</span>
        </li>
        
    </ul>
    </div>

    <div class="related">
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
    


    </div>

    <div class="recent">
        <h4>Recent on Build5Nines.com</h4>
        <ul class="list-unstyled">
        
            <li class="mb-3">
                <a href="https://build5nines.com/map-azure-regions/"><img src="https://i0.wp.com/build5nines.com/wp-content/uploads/2022/08/Azure_Regions_Interactive_Map_2022_Featured_Image.jpg?fit=1200%2C675&ssl=1" alt="Azure Regions: Interactive Map of Global Datacenters"/></a>
                <h6 class="mb-0"><a href="https://build5nines.com/map-azure-regions/">Azure Regions: Interactive Map of Global Datacenters</a></h6>
                <span class="small text-muted">11 Oct 2023</span>
            </li>
        
            <li class="mb-3">
                <a href="https://build5nines.com/how-to-perform-simple-string-concatenation-in-terraform/"><img src="https://i0.wp.com/build5nines.com/wp-content/uploads/2023/02/Terraform_IAC_Featured_Image_2.jpg?fit=1200%2C675&ssl=1" alt="How to Perform Simple String Concatenation in Terraform"/></a>
                <h6 class="mb-0"><a href="https://build5nines.com/how-to-perform-simple-string-concatenation-in-terraform/">How to Perform Simple String Concatenation in Terraform</a></h6>
                <span class="small text-muted">11 Oct 2023</span>
            </li>
        
            <li class="mb-3">
                <a href="https://build5nines.com/terraform-how-are-data-sources-used/"><img src="https://i0.wp.com/build5nines.com/wp-content/uploads/2023/02/Terraform_IAC_Featured_Image_2.jpg?fit=1200%2C675&ssl=1" alt="Terraform: How are Data Sources used?"/></a>
                <h6 class="mb-0"><a href="https://build5nines.com/terraform-how-are-data-sources-used/">Terraform: How are Data Sources used?</a></h6>
                <span class="small text-muted">10 Oct 2023</span>
            </li>
        
            <li class="mb-3">
                <a href="https://build5nines.com/terraform-convert-list-to-map-of-objects-using-for-loop/"><img src="https://i0.wp.com/build5nines.com/wp-content/uploads/2023/02/Terraform_IAC_Featured_Image_2.jpg?fit=1200%2C675&ssl=1" alt="Terraform: Convert List to Map of Objects (using for loop)"/></a>
                <h6 class="mb-0"><a href="https://build5nines.com/terraform-convert-list-to-map-of-objects-using-for-loop/">Terraform: Convert List to Map of Objects (using for loop)</a></h6>
                <span class="small text-muted">09 Oct 2023</span>
            </li>
        
            <li class="mb-3">
                <a href="https://build5nines.com/terraform-convert-string-to-list-join-function/"><img src="https://i0.wp.com/build5nines.com/wp-content/uploads/2023/02/Terraform_IAC_Featured_Image_2.jpg?fit=1200%2C675&ssl=1" alt="Terraform: Convert String to List (join function)"/></a>
                <h6 class="mb-0"><a href="https://build5nines.com/terraform-convert-string-to-list-join-function/">Terraform: Convert String to List (join function)</a></h6>
                <span class="small text-muted">05 Oct 2023</span>
            </li>
        
        </ul>
    </div>

    <!--
    <h4>Courses</h4>
    <style>
        .course-box {
            margin-bottom: 1em;
        }
        .course-box img {
            width: 95%;
        }
        .course-box > strong {
            display: block;
        }
        .course-box > em {
            color: rgba(0,0,0,0.9);
            font-size: 0.9em;
            display: block;
        }
    </style>
    <div class="course-box">
        <a href="https://click.linksynergy.com/deeplink?id=oB4o88BYCr4&mid=39197&murl=https%3A%2F%2Fwww.udemy.com%2Fcourse%2Fthe-complete-javascript-course%2F">
            <img src="/images/udemy/udemy-complete-javascript-course-2020.jpg"/>
        </a>
        <strong>
            <a href="https://click.linksynergy.com/deeplink?id=oB4o88BYCr4&mid=39197&murl=https%3A%2F%2Fwww.udemy.com%2Fcourse%2Fthe-complete-javascript-course%2F">
                The Complete JavaScript Course 2020: Build Real Projects!
            </a>
        </strong>
        <em>by Jonas Schmedtmann</em>
    </div>
    <div class="course-box">
        <a href="https://click.linksynergy.com/deeplink?id=oB4o88BYCr4&mid=39197&murl=https%3A%2F%2Fwww.udemy.com%2Fcourse%2Fjavascript-basics-for-beginners%2F">
            <img src="/images/udemy/udemy-course-javascript-basics-for-beginners.jpg" alt="JavaScript Basics for Beginners course" />
        </a>
        <strong><a href="https://click.linksynergy.com/deeplink?id=oB4o88BYCr4&mid=39197&murl=https%3A%2F%2Fwww.udemy.com%2Fcourse%2Fjavascript-basics-for-beginners%2F">
            JavaScript Basics for Beginners
        </a></strong>
        <em>by Mosh Hamedani</em>
    </div>
    <div class="course-box">
        <a href="https://click.linksynergy.com/deeplink?id=oB4o88BYCr4&mid=39197&murl=https%3A%2F%2Fwww.udemy.com%2Fcourse%2Fadvanced-javascript-concepts%2F">
            <img src="/images/udemy/udemy-course-advanced-javascript-topics.jpg" alt="Advanced JavaScript Concepts course" />
        </a>
        <strong><a href="https://click.linksynergy.com/deeplink?id=oB4o88BYCr4&mid=39197&murl=https%3A%2F%2Fwww.udemy.com%2Fcourse%2Fadvanced-javascript-concepts%2F">
            Advanced JavaScript Concepts
        </a></strong>
        <em>by Andrei Neagoie</em>
    </div>
    -->

    <p style="font-size:0.7em;">
        Copyright © 2003 - 2023 Chris Pietschmann. All rights reserved.<br/><br/>
        No content may be republished without prior consent.
    </p>
    
    <div id="fixedadmarker"></div>
    <div id="fixedad" class="mt-3">
        <div data-type="ad" data-publisher="lqm.pietschsoft.site" data-zone="ron" data-format="160x600"></div>
    </div>
    <style>
    @media (min-width: 768px) {
        .fixedad-float {
            position: fixed;
            top: 2.5em;
        }
    }
    </style>
    <script>
    window.setInterval(function() {
        var elem = $('#fixedadmarker'),
            top = elem.offset().top || 0,
            height = elem[0].offsetHeight || 0,
            bottom = top + height,
            scrollY = window.scrollY || 0,
            elemToBeFixed = $('#fixedad');
        if (scrollY >= bottom) {
            elemToBeFixed.addClass('fixedad-float');
        } else {
            elemToBeFixed.removeClass('fixedad-float');
        }
    }, 100);
    </script>
</div>

    </div>
  </div>
</div>

      </div>
    </div>
    <footer class="container py-5">
  <div class="row">
    <div class="col-6 col-md">
      <h5>Chris Pietschmann</h5>
      <ul class="list-unstyled text-small">
        <li><a class="text-muted" href="/#awards">Microsoft MVP</a></li>
        <li><a class="text-muted" href="/#books">Books</a></li>
        <li><a class="text-muted" href="/#websites">Websites</a></li>
        <li><a class="text-muted" href="/#experience">Experience</a></li>
        <li><a class="text-muted" href="/talks">Talks</a></li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <h5>Publications</h5>
      <ul class="list-unstyled text-small">
        <li><a class="text-muted" href="http://build5nines.com" target="_blank">Build5Nines.com</a></li>
        <li><a class="text-muted" href="https://www.hackster.io/crpietschmann/articles" target="_blank">Hackster.io</a></li>
        <li><a class="text-muted" href="/blog">Pietschsoft.com</a></li>
      </ul>
      <h5>Social Media</h5>
      <ul class="list-unstyled text-small">
        <li><a class="text-muted" href="http://twitter.com/build5nines" target="_blank">Twitter</a></li>
        <li><a class="text-muted" href="http://linkedin.com/in/crpietschmann" target="_blank">LinkedIn</a></li>
        <li><a class="text-muted" href="http://youtube.com/build5nines" target="_blank">YouTube</a></li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <!--<img src="/images/buildazure-logo.png" alt="Build5Nines.com" style="height: 1.5em;"/>-->
      <small class="d-block mb-3 text-muted">
        Copyright © 2003 - 2023 Chris Pietschmann. All rights reserved.<br/><br/>
        No content may be republished without prior consent.
      </small>
      <small class="d-block mb-3 text-muted">
        <strong>Legal Disclaimer</strong>
        <p>This site is a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for sites to earn advertising fees by advertising and linking to Amazon.com. We also participates in affiliate programs with Udemy, and other sites. This site is compensated for referring traffic and business to these companies.</p>
      </small>
    </div>
    <div class="col-12 col-md">
    </div>
  </div>
</footer>

<!-- Bootstrap core JavaScript -->
<!-- Placed at the end of the document so the pages load faster -->
<!--
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
-->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>

<script src="/scripts/prism/prism.js"></script>
<link rel="stylesheet" href="/scripts/prism/prism.css" />


    <!--
    <script type="text/javascript">
    // Google Analytics
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    -->

    <!-- Google Analytics v3
    <script src="https://ssl.google-analytics.com/ga.js" type="text/javascript"></script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-1172995-1");
    pageTracker._trackPageview();
    } catch(err) {}
    </script>
    -->
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QVB6DNH2M1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-QVB6DNH2M1');
  
    
    // Developer Media Ads
    (function() {
      function _dmBootstrap(file) {
          var _dma = document.createElement('script');
          _dma.type = 'text/javascript';
          _dma.async = true;
          _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file;
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
      }
      function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js'); }
      (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000); })();
    })();
    /*
    // Google Analytics v3 - Track External Link Clicks
    (function($) { if ($) {
      $('a[href^=http]').click(function(){
          if (_gaq && _gaq.push && !((this.href || '').startsWith('https://pietschsoft.com'))) {
              _gaq.push(['_trackEvent','Link','External',this.href]);
          }
          return true;
      });
    }})(jQuery);
    */
  </script>
  </body>
</html>