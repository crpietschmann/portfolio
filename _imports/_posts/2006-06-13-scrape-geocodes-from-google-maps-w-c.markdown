  ---
  layout: post
  title: "Scrape Geocodes from Google Maps w/ C#"
  date: 2006-06-13 09:00:00 -0500
  comments: true
  published: true
  categories: ["blog", "archives"]
  tags: ["C#"]
  alias: ["/post/2006/06/13/Scrape-Geocodes-from-Google-Maps-w-C", "/post/2006/06/13/scrape-geocodes-from-google-maps-w-c"]
  ---
<!-- more -->
{% include imported_disclaimer.html %}
<p>I need to geocode some addresses once in a while and I notice if you view the source of the Google Maps page, the geocodes are right there. So instead of looking at the source of the page manually, I just created a little app that scrapes them from the page for me and places them into textboxes.</p>
<p>Below is a small code snippet I wrote that does just that. It's not perfect but it is simple and it just plain works.</p>
<p><span style="color: #0000ff; font-size: x-small;"> </span></p>
<p><span style="color: #0000ff; font-size: x-small;">string</span><span style="font-size: x-small;"> lat = </span><span style="color: #800000; font-size: x-small;">""</span><span style="font-size: x-small;">;<br /></span><span style="color: #0000ff; font-size: x-small;">string</span><span style="font-size: x-small;"> lng = </span><span style="color: #800000; font-size: x-small;">""</span><span style="font-size: x-small;">;<br /></span><span style="color: #0000ff; font-size: x-small;">string</span><span style="font-size: x-small;"> address = </span><span style="color: #800000; font-size: x-small;">"1 Microsoft Way, Redmond WA"</span><span style="font-size: x-small;">;</span></p>
<p><span style="font-size: x-small;"> </span></p>
<p><span style="color: #0000ff; font-size: x-small;">try<br /></span><span style="font-size: x-small;">{<br />System.Net.</span><span style="color: #008080; font-size: x-small;">WebClient</span><span style="font-size: x-small;"> client = </span><span style="color: #0000ff; font-size: x-small;">new</span><span style="font-size: x-small;"> System.Net.</span><span style="color: #008080; font-size: x-small;">WebClient</span><span style="font-size: x-small;">();<br /></span><span style="color: #0000ff; font-size: x-small;">string</span><span style="font-size: x-small;"> page = client.DownloadString(</span><span style="color: #800000; font-size: x-small;">"http://maps.google.com/maps?q="</span><span style="font-size: x-small;"> + address);<br /></span><span style="color: #0000ff; font-size: x-small;">int</span><span style="font-size: x-small;"> begin = page.IndexOf(</span><span style="color: #800000; font-size: x-small;">"markers: ["</span><span style="font-size: x-small;">);<br /></span><span style="color: #0000ff; font-size: x-small;">string</span><span style="font-size: x-small;"> str = page.Substring(begin);<br /></span><span style="color: #0000ff; font-size: x-small;">int</span><span style="font-size: x-small;"> end = str.IndexOf(</span><span style="color: #800000; font-size: x-small;">",image:"</span><span style="font-size: x-small;">);<br />str = str.Substring(0, end);</span></p>
<p><span style="color: #008000; font-size: x-small;">//Parse out Latitude<br /></span><span style="font-size: x-small;">lat = str.Substring(str.IndexOf(</span><span style="color: #800000; font-size: x-small;">",lat: "</span><span style="font-size: x-small;">) + 6);<br />lat = lat.Substring(0, lat.IndexOf(</span><span style="color: #800000; font-size: x-small;">",lng: "</span><span style="font-size: x-small;">));<br /></span><span style="color: #008000; font-size: x-small;">//Parse out Longitude<br /></span><span style="font-size: x-small;">lng = str.Substring(str.IndexOf(</span><span style="color: #800000; font-size: x-small;">",lng: "</span><span style="font-size: x-small;">) + 6);<br />}<br /></span><span style="color: #0000ff; font-size: x-small;">catch</span><span style="font-size: x-small;"> (</span><span style="color: #008080; font-size: x-small;">Exception</span><span style="font-size: x-small;"> ex)<br />{<br /></span><span style="color: #008080; font-size: x-small;">MessageBox</span><span style="font-size: x-small;">.Show(</span><span style="color: #800000; font-size: x-small;">"An Error Occured Loading Geocode!\nCheck that a valid address has been entered."</span><span style="font-size: x-small;">, </span><span style="color: #800000; font-size: x-small;">"An Error Occured Loading Geocode!"</span><span style="font-size: x-small;">);<br />}<br /></span><span style="color: #008080; font-size: x-small;">MessageBox</span><span style="font-size: x-small;">.Show(</span><span style="color: #800000; font-size: x-small;">"Latitude:\n"</span><span style="font-size: x-small;"> + lat + </span><span style="color: #800000; font-size: x-small;">"\n\nLongitude:\n"</span><span style="font-size: x-small;"> + lng);</span></p>
<p>&nbsp;</p>
<p>I know I should have used Regular Expressions, but I don't know them very well and this was just quicker/easier to do. It took all of like 5 minutes.</p>
